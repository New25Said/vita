<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vita26 | Hub de Aplicaciones</title>

  <!-- Fuentes Externas -->
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/helvetica-world" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/glacial-indifference" rel="stylesheet">

  <style>
    /* Variables de Dise帽o */
    :root {
      --bg-main: #060b13;
      --bg-accent: #0d1e31;
      --card-bg: #0a1929;
      --card-border: rgba(255, 255, 255, 0.1);
      --accent-blue: #2f7cff;
      --accent-red: #ff2f2f;
      --accent-orange: #FF751F;
      --accent-green: #2ecc71;
      --text-primary: #ffffff;
      --text-secondary: #b0c4de;
    }

    /* Reset y Estilos Base */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), background 0.3s ease, border-color 0.3s ease, opacity 0.4s ease;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top center, var(--bg-accent) 0%, var(--bg-main) 100%);
      background-attachment: fixed;
      font-family: 'Open Sans', sans-serif;
      color: var(--text-primary);
      overflow-x: hidden;
      line-height: 1.6;
    }

    /* PANTALLA DE BLOQUEO */
    #lock-screen {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at center, #0d1e31 0%, #060b13 100%);
      z-index: 9999;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      backdrop-filter: blur(20px);
    }

    .lock-card {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      padding: 40px;
      border-radius: 24px;
      text-align: center;
      max-width: 400px;
      width: 100%;
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    }

    .lock-title {
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 32px;
      margin-bottom: 20px;
    }

    .lock-input {
      width: 100%;
      height: 50px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--card-border);
      border-radius: 12px;
      padding: 0 20px;
      color: white;
      font-size: 18px;
      text-align: center;
      letter-spacing: 4px;
      outline: none;
      margin-bottom: 20px;
    }

    .lock-input:focus {
      border-color: var(--accent-blue);
      box-shadow: 0 0 15px rgba(47, 124, 255, 0.3);
    }

    .btn-auth {
      width: 100%;
      height: 50px;
      background: var(--accent-blue);
      border: none;
      border-radius: 12px;
      color: white;
      font-weight: 700;
      text-transform: uppercase;
      cursor: pointer;
      font-family: 'Glacial Indifference', sans-serif;
    }

    .btn-auth:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .error-msg {
      color: var(--accent-red);
      font-size: 14px;
      margin-top: 15px;
      display: none;
    }

    /* BARRA SUPERIOR */
    .top-bar {
      width: 100%;
      height: 64px;
      background: rgba(5, 12, 21, 0.85);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--card-border);
      position: sticky;
      top: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      padding: 0 24px;
      justify-content: flex-start;
      gap: 20px;
    }

    .top-logo {
      height: 32px;
      width: 32px;
      filter: drop-shadow(0 0 5px var(--accent-blue));
    }

    .search-container {
      position: relative;
      flex: 0 1 400px;
    }

    .search-input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
    }

    .search-input {
      width: 100%;
      height: 38px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--card-border);
      border-radius: 10px;
      padding: 0 15px 0 40px;
      color: white;
      font-family: 'Open Sans', sans-serif;
      font-size: 14px;
      outline: none;
    }

    .search-input:focus {
      border-color: var(--accent-blue);
      background: rgba(255, 255, 255, 0.08);
      box-shadow: 0 0 15px rgba(47, 124, 255, 0.2);
    }

    .search-icon {
      position: absolute;
      left: 12px;
      width: 18px;
      height: 18px;
      stroke: var(--text-secondary);
      pointer-events: none;
    }

    .autocomplete-results {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      right: 0;
      background: #0d1e31;
      border: 1px solid var(--card-border);
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      max-height: 300px;
      overflow-y: auto;
      display: none;
      z-index: 1100;
    }

    .autocomplete-item {
      padding: 12px 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      outline: none;
    }

    .autocomplete-item:hover, .autocomplete-item:focus, .autocomplete-item.active {
      background: rgba(47, 124, 255, 0.25);
      border-left: 3px solid var(--accent-blue);
      padding-left: 13px;
    }

    /* Contenido Principal */
    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 20px;
      width: 100%;
    }

    .hero-section {
      display: flex;
      gap: 24px;
      margin-top: 40px;
      align-items: stretch;
    }

    .side-card {
      flex: 1;
      background: linear-gradient(145deg, rgba(10, 25, 41, 0.4), rgba(5, 12, 21, 0.2));
      border-radius: 24px;
      border: 1px solid var(--card-border);
      backdrop-filter: blur(4px);
    }

    .main-card {
      flex: 3;
      background: var(--card-bg);
      border-radius: 28px;
      padding: 56px 40px;
      border: 1px solid var(--card-border);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .title {
      font-family: 'Glacial Indifference', sans-serif;
      font-size: clamp(48px, 8vw, 80px);
      letter-spacing: -4px;
      font-weight: 700;
      line-height: 1;
    }

    .v { color: #fff; }
    .i { color: var(--accent-blue); }
    .t { 
      background: linear-gradient(90deg, var(--accent-blue), var(--accent-red));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .a { color: var(--accent-red); }
    .num { 
      color: var(--accent-orange); 
      margin-left: 8px;
      font-weight: 400;
      letter-spacing: -2px;
      text-shadow: 0 0 20px rgba(255, 117, 31, 0.3);
    }

    .logo-img {
      width: 72px;
      height: 72px;
      margin: 20px auto;
      filter: drop-shadow(0 0 15px rgba(47, 124, 255, 0.4));
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .divider {
      width: 100%;
      height: 4px;
      background: rgba(255, 255, 255, 0.05);
      margin: 50px 0;
      position: relative;
      border-radius: 2px;
      overflow: hidden;
    }

    .divider::after {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 50%;
      background: linear-gradient(90deg, transparent, var(--accent-blue), var(--accent-red), transparent);
      animation: slide 4s linear infinite;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 32px;
    }

    .section-title {
      font-family: 'Glacial Indifference', sans-serif;
      font-size: 28px;
      letter-spacing: 1px;
      text-transform: uppercase;
    }

    .line {
      flex: 1;
      height: 1px;
      background: linear-gradient(90deg, var(--card-border), transparent);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 30px;
      margin-bottom: 60px;
    }

    .item-card {
      position: relative;
      border-radius: 22px;
      padding: 24px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      background: var(--card-bg);
      overflow: hidden; 
      z-index: 1;
      border: 1px solid var(--card-border);
    }

    .item-card::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: conic-gradient(transparent 0%, var(--accent-blue) 25%, var(--accent-red) 50%, transparent 75%);
      animation: rotate-border 3s linear infinite;
      z-index: -2;
      opacity: 0;
    }

    .item-card::after {
      content: '';
      position: absolute;
      inset: 2px;
      background: var(--card-bg);
      border-radius: 20px;
      z-index: -1;
    }

    @keyframes rotate-border { 100% { transform: rotate(1turn); } }

    .item-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
      border-color: transparent;
    }

    .item-card:hover::before { opacity: 1; }

    .item-header { display: flex; gap: 16px; align-items: center; }
    .item-icon {
      width: 64px; height: 64px; border-radius: 16px; background: var(--bg-main);
      border: 1px solid var(--card-border); display: flex; align-items: center; justify-content: center; font-size: 24px; z-index: 2;
    }
    .item-banner { flex: 1; height: 64px; border-radius: 16px; background: linear-gradient(135deg, #0a1e36 0%, #051221 100%); }
    .item-desc { font-family: 'Helvetica World', sans-serif; font-size: 15px; color: var(--text-secondary); min-height: 45px; }

    .button-group { display: flex; gap: 12px; margin-top: auto; }
    .btn {
      flex: 1; height: 44px; border: 1px solid transparent; border-radius: 12px;
      font-family: 'Glacial Indifference', sans-serif; font-size: 13px; font-weight: 600;
      text-transform: uppercase; letter-spacing: 1px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; color: white;
    }

    .icon-svg { width: 18px; height: 18px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
    .btn-open { background: rgba(46, 204, 113, 0.1); color: #2ecc71; border-color: rgba(46, 204, 113, 0.2); }
    .btn-open:hover { background: #2ecc71; color: #fff; }
    .btn-install { background: rgba(47, 124, 255, 0.1); color: #3498db; border-color: rgba(47, 124, 255, 0.2); }
    .btn-install:hover { background: #2f7cff; color: #fff; }

    @media (max-width: 900px) {
      .side-card { display: none; }
      .main-card { flex: 1; padding: 40px 24px; }
      .search-container { flex: 1; }
    }
  </style>
</head>
<body>

<!-- Lock Screen -->
<div id="lock-screen">
  <div class="lock-card">
    <h2 class="lock-title">Autorizaci贸n Requerida</h2>
    <p style="margin-bottom: 20px; color: var(--text-secondary);">Introduce tu c贸digo de acceso 煤nico para continuar.</p>
    <input type="text" class="lock-input" id="authCodeInput" placeholder="XXXXXX" maxlength="10">
    <button class="btn-auth" id="btnAuth">Acceder</button>
    <p class="error-msg" id="errorMsg">C贸digo inv谩lido o ya utilizado.</p>
  </div>
</div>

<div id="main-content" style="display: none;">
  <nav class="top-bar">
    <svg class="top-logo" viewBox="0 0 24 24" fill="none" stroke="url(#logoGradBar)" stroke-width="2">
      <defs>
        <linearGradient id="logoGradBar" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#2f7cff" /><stop offset="100%" style="stop-color:#ff2f2f" />
        </linearGradient>
      </defs>
      <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
    </svg>

    <div class="search-container">
      <div class="search-input-wrapper">
        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        <input type="text" class="search-input" id="searchBox" placeholder="Buscar..." autocomplete="off">
      </div>
      <div class="autocomplete-results" id="resultsList"></div>
    </div>
  </nav>

  <main class="container">
    <section class="hero-section">
      <div class="side-card"></div>
      <div class="main-card">
        <h1 class="title"><span class="v">V</span><span class="i">i</span><span class="t">t</span><span class="a">a</span><span class="num">26</span></h1>
        <svg class="logo-img" viewBox="0 0 24 24" fill="none" stroke="url(#logoGrad)" stroke-width="1.5">
          <defs><linearGradient id="logoGrad" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#2f7cff" /><stop offset="100%" style="stop-color:#ff2f2f" /></linearGradient></defs>
          <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
        </svg>
        <p class="subtitle">Hub curado de herramientas y entretenimiento digital.</p>
      </div>
      <div class="side-card"></div>
    </section>

    <div class="divider"></div>

    <header class="section-header"><h2 class="section-title">Aplicaciones</h2><div class="line"></div></header>
    <div class="grid" id="appsGrid">
      <article class="item-card" data-name="Gestor de Archivos">
        <div class="item-header"><div class="item-icon">锔</div><div class="item-banner"></div></div>
        <p class="item-desc">Gestor de archivos y herramientas de sistema avanzadas.</p>
        <div class="button-group">
          <button class="btn btn-open">Abrir</button>
          <button class="btn btn-install">Instalar</button>
        </div>
      </article>
    </div>

    <header class="section-header"><h2 class="section-title">Juegos</h2><div class="line"></div></header>
    <div class="grid" id="gamesGrid">
      <article class="item-card" data-name="Aventura RPG">
        <div class="item-header"><div class="item-icon"></div><div class="item-banner"></div></div>
        <p class="item-desc">Aventura RPG 茅pica con mundos abiertos.</p>
        <div class="button-group">
          <button class="btn btn-open">Abrir</button>
          <button class="btn btn-install">Instalar</button>
        </div>
      </article>
    </div>
  </main>
</div>

<!-- Firebase Config -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
  import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

  const firebaseConfig = JSON.parse(__firebase_config);
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

  const lockScreen = document.getElementById('lock-screen');
  const mainContent = document.getElementById('main-content');
  const authInput = document.getElementById('authCodeInput');
  const btnAuth = document.getElementById('btnAuth');
  const errorMsg = document.getElementById('errorMsg');

  // Verificar si ya est谩 autorizado en este navegador
  if (localStorage.getItem('v26_authorized') === 'true') {
    lockScreen.style.display = 'none';
    mainContent.style.display = 'block';
  }

  const handleAuth = async () => {
    const code = authInput.value.trim().toUpperCase();
    if (!code) return;

    btnAuth.disabled = true;
    errorMsg.style.display = 'none';

    try {
      // Iniciar sesi贸n
      if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
        await signInWithCustomToken(auth, __initial_auth_token);
      } else {
        await signInAnonymously(auth);
      }

      // Buscar c贸digo en la colecci贸n p煤blica
      const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'authCodes', code);
      const docSnap = await getDoc(docRef);

      if (docSnap.exists() && docSnap.data().used === false) {
        // Marcar como usado
        await updateDoc(docRef, { used: true, usedAt: Date.now() });
        
        // Desbloquear
        localStorage.setItem('v26_authorized', 'true');
        lockScreen.style.opacity = '0';
        setTimeout(() => {
          lockScreen.style.display = 'none';
          mainContent.style.display = 'block';
        }, 300);
      } else {
        errorMsg.style.display = 'block';
      }
    } catch (e) {
      console.error(e);
      errorMsg.textContent = "Error de conexi贸n. Int茅ntalo de nuevo.";
      errorMsg.style.display = 'block';
    } finally {
      btnAuth.disabled = false;
    }
  };

  btnAuth.onclick = handleAuth;
  authInput.onkeydown = (e) => { if (e.key === 'Enter') handleAuth(); };

  // --- L贸gica de B煤squeda (ya existente) ---
  const searchableItems = [
    { name: "Gestor de Archivos", type: "App", icon: "锔" },
    { name: "Navegador Seguro", type: "App", icon: "" },
    { name: "Aventura RPG", type: "Juego", icon: "" },
    { name: "Simulador Espacial", type: "Juego", icon: "" }
  ];

  const searchBox = document.getElementById('searchBox');
  const resultsList = document.getElementById('resultsList');
  
  searchBox.addEventListener('input', (e) => {
    const val = e.target.value.toLowerCase();
    resultsList.innerHTML = '';
    if (val.length < 1) { resultsList.style.display = 'none'; return; }
    const filtered = searchableItems.filter(item => item.name.toLowerCase().includes(val));
    if (filtered.length > 0) {
      filtered.forEach(item => {
        const div = document.createElement('div');
        div.className = 'autocomplete-item';
        div.innerHTML = `<span>${item.icon}</span><div style="flex:1"><b>${item.name}</b></div><span style="font-size:10px; opacity:0.6">${item.type}</span>`;
        div.onclick = () => {
          searchBox.value = item.name;
          resultsList.style.display = 'none';
          const target = document.querySelector(`[data-name="${item.name}"]`);
          if (target) target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        };
        resultsList.appendChild(div);
      });
      resultsList.style.display = 'block';
    } else { resultsList.style.display = 'none'; }
  });
</script>

</body>
</html>
